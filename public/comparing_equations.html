<!DOCTYPE html>
<html>

<head>
  <script id="Polyfill" src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script id="Markdown" src="https://cdn.jsdelivr.net/gh/markedjs/marked@bf1295a499c60abc096124ab33804071cb8d89fe/marked.min.js"></script>

  <!-- Import maps polyfill -->
	<!-- Remove this when import-maps will be widely supported -->
	<script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>
  <script id="ThreeJS" type="importmap">
    {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.144.0/build/three.module.js",
        "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.144.0/examples/jsm/"
      }
    }
  </script>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8" />

  <title>Physics</title>
  <link rel="icon" type="image/svg+xml" href="physics.svg">

  <script src="tools/canvas/shapes.js"></script>
  <script src="equations.js"></script>
  <link rel="stylesheet" type="text/css" href="physics.css" />
</head>

<body>
  <script id="SideBar" src="./sidebar/sidebar.js"></script>
  <div class="page">
    <article class="page-content">

      <div class="markdown">
        # <center><u style="font-family: 'Times New Roman';">Comparing Equations</u></center>

        ## Specifying custom path:

        just put your points and the path will automatically update
        
        - diagram updates after 3 sec when not modfying
        - if it didnt updated, then the input values are not valid

        ### Circuit 1 Path:
      </div>
      <textarea id="path1" rows="10">
 150,  150, 0,
 150, -150, 0,
-150, -150, 0,
-150,  150, 0,
 150,  150, 0
      </textarea>
      <div class="markdown">
        ### Circuit 2 Path:
      </div>
      <textarea id="path2" rows="10">
 150,  150, 0,
 150,   0,  0,
 150,   0,  150,
-150,   0,  150,
-150,  150, 0,
 150,  150, 0
      </textarea>
      <br/>
      <br/>
      <canvas-video id="calc_custom_paths" name="calc_custom_paths" type="calculate" style="position: relative;"></canvas-video>
      <div class="markdown" id="examples">
        for faradays law paradox  
        try putting:
        ```
        0.00, 150.00,0.00
        46.10, 141.88,0.00
        88.17, 121.35,0.00
        120.69, 87.68,0.00
        142.66, 46.35,0.00
        149.18, -0.00,0.00
        142.66, -46.35,0.00
        120.69, -87.68,0.00
        88.17, -121.35,0.00
        46.10, -141.88,0.00
        -0.00, -150.00,0.00
        -46.10, -141.88,0.00
        -88.17, -121.35,0.00
        -120.69, -87.68,0.00
        -142.66, -46.35,0.00
        -149.18, 0.00,0.00
        -142.66, 46.35,0.00
        -120.69, 87.68,0.00
        -88.17, 121.35,0.00
        -46.10, 141.88,0.00
        0.00, 150.00,0.00
        ```
        and
        ```
        -10 0 -400
        10 0 -400
        ```
        on the wires paths

        toggle to my equation, and change V_y (you can try both positive and negative).

        <button onclick="document.getElementById('path1').innerHTML = '0.00, 150.00,0.00\n46.10, 141.88,0.00\n88.17, 121.35,0.00\n120.69, 87.68,0.00\n142.66, 46.35,0.00\n149.18, -0.00,0.00\n142.66, -46.35,0.00\n120.69, -87.68,0.00\n88.17, -121.35,0.00\n46.10, -141.88,0.00\n-0.00, -150.00,0.00\n-46.10, -141.88,0.00\n-88.17, -121.35,0.00\n-120.69, -87.68,0.00\n-142.66, -46.35,0.00\n-149.18, 0.00,0.00\n-142.66, 46.35,0.00\n-120.69, 87.68,0.00\n-88.17, 121.35,0.00\n-46.10, 141.88,0.00\n0.00, 150.00,0.00'; document.getElementById('path2').innerHTML = '-10 0 -400\n10 0 -400'; document.getElementById('path1').dispatchEvent(new Event('input'))">Check</button>

        <-- TODO instead of harcoded inserting text, make general function that reads and inserts
        also add this:
        toolbar.children[1].children[0].children[0].value = a
        toolbar.children[1].children[0].children[0].onchange()
        -->

        you sould also try putting:
        ```
        0 0 0
        0 0 1
        ```
        and
        ```
        0 0 0
        1 0 0
        ```

        <button onclick="document.getElementById('path1').innerHTML = '0 0 0\n0 0 1'; document.getElementById('path2').innerHTML = '0 0 0\n1 0 0'; document.getElementById('path1').dispatchEvent(new Event('input'))">Check</button>

        also check out the volate when the wires are:
        ```
        500 0 0
        -500 0 0
        ```
        and
        ```
        500 0 0
        -500 0 0
        ```
        and V_z has some speed

        <button onclick="document.getElementById('path1').innerHTML = '500 0 0\n-500 0 0'; document.getElementById('path2').innerHTML = '500 0 0\n-500 0 0'; document.getElementById('path1').dispatchEvent(new Event('input'))">Check</button>

      </div>
    </article>
  </div>

  <script async>
    // Parse markdown
    document.querySelectorAll('.markdown').forEach(elmNode => {
      fisrt_spaces = elmNode.innerHTML.match(/^\n*( *)[^ ]/)[1]
      elmNode.innerHTML = marked.parse(elmNode.innerHTML.replace(new RegExp("\n" + fisrt_spaces, "g"), "\n"))
    });
  </script>
  <script type="module">
    import { Path3 } from './tools/threejs/path3.js'

    const calc_custom_paths = document.getElementById("calc_custom_paths")

    const modfying = []
    const input1 = document.getElementById("path1")
    const input2 = document.getElementById("path2")

    let path1
    let path2

    function update_calc() {
      modfying.push(true)
      new Promise(r => setTimeout(r, 3000)).then(function() {
        modfying.pop()
        if (modfying.length == 0) {
          const arr1 = JSON.parse("[" + input1.value.replace(/\n| /g, ",").replace(/[,]+/g, ",").replace(/^,|,$/g, "") + "]")
          const arr2 = JSON.parse("[" + input2.value.replace(/\n| /g, ",").replace(/[,]+/g, ",").replace(/^,|,$/g, "") + "]")

          if (arr1.length % 3 == 0 && arr2.length % 3 == 0 && arr1.length >= 6 && arr2.length >= 6 && arr1.every(num => typeof num === 'number') && arr2.every(num => typeof num === 'number')) {
            path1.setPoints(arr1)
            path2.setPoints(arr2)

            const old_canvas = document.getElementById("calc_custom_paths")
            old_canvas.parentNode.replaceChild(calc_custom_paths, old_canvas)
            old_canvas.replace_animation(calc_custom_paths)
          }
        }
      })
    }

    input1.addEventListener('input', update_calc)
    input2.addEventListener('input', update_calc)

    path1 = new Path3(JSON.parse("[" + input1.value.replace(/\n| /g, ",").replace(/[,]+/g, ",").replace(/^,|,$/g, "") + "]"))
    path2 = new Path3(JSON.parse("[" + input2.value.replace(/\n| /g, ",").replace(/[,]+/g, ",").replace(/^,|,$/g, "") + "]"))
    window.calc_custom_paths_init = function (toolbar, scene) {
      window.calc_force_init(toolbar, scene, path1, path2)
    }

    window.calc_custom_paths = function (toolbar, scene) {
      window.calc_force(toolbar, scene)
    }
  </script>
  <script src="drawings.js"></script>
  <script type="module" src="3d_forces.js"></script>
  <script id="CanvasVideo" type="module" src="./canvas_video/animation.js"></script>
</body>
</html>
